<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>FruitsMash</title>
</head>
<body>
  <h2 id="question">Chargement...</h2>
  <button id="btn1">...</button>
  <button id="btn2">...</button>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbwODS6RAgTf9eMgVPJ77LBSQSPrvMBm1-9dqcYcQFPqLqx2MAA4OuKHj-2rxmlO1QSedw/exec";
    let fruit1, fruit2, critere;

    async function loadMatchup() {
      const res = await fetch(API_URL);
      const data = await res.json();

      fruit1 = data.fruit1;
      fruit2 = data.fruit2;
      critere = data.critere;

      document.getElementById("question").textContent = `Cliquez sur le plus ${critere} :`;
      document.getElementById("btn1").textContent = fruit1;
      document.getElementById("btn2").textContent = fruit2;
    }

    async function vote(winner) {
      const formData = new URLSearchParams();
      formData.append("fruit1", fruit1);
      formData.append("fruit2", fruit2);
      formData.append("critere", critere);
      formData.append("winner", winner);

      const res = await fetch(API_URL, {
        method: "POST",
        body: formData
      });

      const result = await res.text(); // ou .json() si tu renvoies du JSON
      console.log("RÃ©sultat du vote :", result);
      loadMatchup();
    }


    document.getElementById("btn1").addEventListener("click", () => vote(fruit1));
    document.getElementById("btn2").addEventListener("click", () => vote(fruit2));

    loadMatchup();
  </script>
</body>
</html>
